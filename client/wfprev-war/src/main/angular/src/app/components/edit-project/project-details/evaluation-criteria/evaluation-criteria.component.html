<div>
    <mat-expansion-panel #panel="matExpansionPanel">
        <mat-expansion-panel-header class="expansion-panel-header">
          <mat-panel-title class="project-title">
            <div class="custom-indicator">
                <wfprev-expansion-indicator [isExpanded]="panel.expanded"></wfprev-expansion-indicator>
            </div>
            <span>Evaluation Criteria</span>
          </mat-panel-title>
          <mat-panel-description class="edit-evaluation-criteria">
            <div (click)="openEvaluationCriteriaPopUp(); $event.stopPropagation()">
              <img alt="edit-icon" class="icon" src="/assets/edit-icon.svg" />
              <span>Edit</span>
            </div>
          </mat-panel-description>
        </mat-expansion-panel-header>
        <!-- Fuel Management -->
        <div *ngIf="project?.projectTypeCode?.projectTypeCode === 'FUEL_MGMT' && evaluationCriteriaSummary">
          <div class="criteria-section">
            <div class="section-label">
              <span>Coarse Filter Total:</span>
              <span>
                {{ evaluationCriteriaSummary?.localWuiRiskClassCode?.weightedRank
                    ?? evaluationCriteriaSummary?.wuiRiskClassCode?.weightedRank
                    ?? 0
                }}
              </span>
            </div>

            <div class="criteria-details">
              <div class="criteria-item criteria-item-narrow">
                <span>WUI Risk Class</span>
                <span>{{ formatCodeLabel(evaluationCriteriaSummary?.wuiRiskClassCode?.wuiRiskClassCode) || '' }}</span>
              </div>
              <div class="criteria-item criteria-item-narrow">
                <span>Local Risk Class</span>
                <span>{{ formatCodeLabel(evaluationCriteriaSummary?.localWuiRiskClassCode?.wuiRiskClassCode) || '' }}</span>
              </div>
              <div class="criteria-item">
                <span>Local WUI Risk Class Rationale:</span>
                <span>{{ evaluationCriteriaSummary?.localWuiRiskClassRationale || 'None' }}</span>
              </div>
            </div>

            <span class="section-label">
              Medium Filter Total:
              <span>{{ getSectionTotal(evaluationCriteriaSummary, 'MEDIUM_FLT') }}</span>
            </span>
            <div class="criteria-details">
              <div class="criteria-item">
                <span>Medium Filter Comments:</span>
                <span>{{ getSectionComment(evaluationCriteriaSummary, 'MEDIUM_FLT') || 'None' }}</span>
              </div>
            </div>

            <span class="section-label">
              Fine Filter Total:
              <span>{{ getSectionTotal(evaluationCriteriaSummary, 'FINE_FLT') }}</span>
            </span>
            <div class="criteria-details">
              <div class="criteria-item">
              <span>Fine Filter Comments:</span>
              <span>{{ getSectionComment(evaluationCriteriaSummary, 'FINE_FLT') || 'None' }}</span>
              </div>
            </div>
            <div class="full-width-divider"></div>
            <div class="section-label ">
              <span>Calculated Total</span>
              <span>{{ getCalculatedTotal(evaluationCriteriaSummary) }}</span>
            </div>
          </div>
        </div>

    </mat-expansion-panel>
</div>