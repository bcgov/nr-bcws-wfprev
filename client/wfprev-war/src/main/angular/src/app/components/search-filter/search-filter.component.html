<div class="search-filter-bar">
  <div class="filter-row">
    <!-- Search input -->
    <div class="field search-input textsearch">
      <mat-label class="label">Search</mat-label>
      <input class="search-input" aria-label="Search"
        [(ngModel)]="searchText"
        (ngModelChange)="searchTextChanged.next($event)" 
      />
      <button *ngIf="searchText.length" mat-icon-button class="input-search-button"
              aria-label="Search"
              matTooltip="Search"
              (click)="clearSearch(); $event.stopPropagation()">
        <mat-icon>close</mat-icon>
      </button>
    </div>
    

    <!-- Filters -->
    <div class="field search-input filter-search-input">
      <mat-label class="label">Business Area</mat-label>
      <mat-form-field appearance="fill" class="filter-item">
        <mat-select [(ngModel)]="selectedBusinessArea" placeholder="Select"
          (selectionChange)="onOptionToggled($event,'selectedBusinessArea', businessAreaOptions)"
          multiple>
        <mat-option *ngFor="let option of businessAreaOptions" [value]="option.value" (onSelectionChange)="syncAllWithItemToggle($event, option.value, 'selectedBusinessArea', businessAreaOptions)">
          {{ option.label }}
        </mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <div class="field search-input filter-search-input">
      <mat-label class="label">Fiscal Year(s)</mat-label>
      <mat-form-field appearance="fill" class="filter-item">
        <mat-select [(ngModel)]="selectedFiscalYears" placeholder="Select"
                    (selectionChange)="onOptionToggled($event,'selectedFiscalYears', fiscalYearOptions)"
                    multiple>
          <mat-option *ngFor="let option of fiscalYearOptions" [value]="option.value" (onSelectionChange)="syncAllWithItemToggle($event, option.value, 'selectedFiscalYears', fiscalYearOptions)">
            {{ option.label }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    
    <div class="field search-input filter-search-input">
      <mat-label class="label">Activity Category</mat-label>
      <mat-form-field appearance="fill" class="filter-item">
        <mat-select [(ngModel)]="selectedActivity" placeholder="Select"
                    (selectionChange)="onOptionToggled($event,'selectedActivity', activityOptions)"
                    multiple>
          <mat-option *ngFor="let option of activityOptions" [value]="option.value" (onSelectionChange)="syncAllWithItemToggle($event, option.value, 'selectedActivity', activityOptions)">
            {{ option.label }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    
    <div class="field search-input filter-search-input">
      <mat-label class="label">Forest Region</mat-label>
      <mat-form-field appearance="fill" class="filter-item">
        <mat-select [(ngModel)]="selectedForestRegion" placeholder="Select"
                    (ngModelChange)="onForestRegionChange()"
                    (selectionChange)="onOptionToggled($event,'selectedForestRegion', forestRegionOptions)"
                    multiple>
          <mat-option *ngFor="let option of forestRegionOptions" [value]="option.value" (onSelectionChange)="syncAllWithItemToggle($event, option.value, 'selectedForestRegion', forestRegionOptions)">
            {{ option.label }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    
    <div class="field search-input filter-search-input">
      <mat-label class="label">Forest District</mat-label>
      <mat-form-field appearance="fill" class="filter-item">
        <mat-select [(ngModel)]="selectedForestDistrict" placeholder="Select"
                    (selectionChange)="onOptionToggled($event,'selectedForestDistrict', forestDistrictOptions)"
                    multiple>
          <mat-option *ngFor="let option of forestDistrictOptions" [value]="option.value" (onSelectionChange)="syncAllWithItemToggle($event, option.value, 'selectedForestDistrict', forestDistrictOptions)">
            {{ option.label }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    
    <div class="field search-input filter-search-input">
      <mat-label class="label">Fire Centre</mat-label>
      <mat-form-field appearance="fill" class="filter-item">
        <mat-select [(ngModel)]="selectedFireCentre" placeholder="Select"
                    (selectionChange)="onOptionToggled($event,'selectedFireCentre', fireCentreOptions)"
                    multiple>
          <mat-option *ngFor="let option of fireCentreOptions" [value]="option.value" (onSelectionChange)="syncAllWithItemToggle($event, option.value, 'selectedFireCentre', fireCentreOptions)">
            {{ option.label }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <div class="field search-input filter-search-input">
      <mat-label class="label">Fiscal Status</mat-label>
      <mat-form-field appearance="fill" class="filter-item">
        <mat-select [(ngModel)]="selectedFiscalStatus" placeholder="Select"
                    (selectionChange)="onOptionToggled($event,'selectedFiscalStatus', fiscalStatusOptions)"
                    multiple>
          <mat-option *ngFor="let option of fiscalStatusOptions" [value]="option.value" (onSelectionChange)="syncAllWithItemToggle($event, option.value, 'selectedFiscalStatus', fiscalStatusOptions)">
            {{ option.label }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>
        

    <!-- Reset button -->
    <button mat-stroked-button class="filter-item reset-button" (click)="onReset()">Reset</button>
  </div>
</div>
